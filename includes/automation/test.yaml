- alias: Test - Send Message when input boolean change
  initial_state: 'on'
  trigger:
    - platform: state
      entity_id: input_boolean.test
      from: 'off'
      to: 'on'
  action:
    -  service: persistent_notification.create
       data_template:
         title: "Before"
         message: >
          {{states(trigger.entity_id)}}
          {{is_state(trigger.entity_id,'off')}}
    - wait_template: "{{is_state('trigger.entity_id','off')}}"
      timeout: 00:00:30
    -  service: persistent_notification.create
       data_template:
         title: "After"
         message: >
          {{trigger.entity_id}}
          {{is_state(trigger.entity_id,'off')}}

        
#- alias: test wait state
#  initial_state: 'off'
#  trigger:
#    platform: state
#    entity_id: device_tracker.ryans_iphone_app
#  action:
#    - service: notify.ios_ryans_iphone_app
#      data:
#        message: "before wait states"
#    - wait_template: "{{states.input_boolean.test.state == on}}"
#      timeout: 00:01:00
#    - service: notify.ios_ryans_iphone_app
#      data:
#        message: "after wait states"

#- alias: test wait is_state
#  initial_state: 'off'
#  trigger:
#    platform: state
#    entity_id: device_tracker.ryans_iphone_app
#  action:
#    - service: notify.ios_ryans_iphone_app
#      data:
#        message: "before wait is state"
#    - wait_template: "{{is_state('input_boolean.test', 'on')}}"
#      timeout: 00:01:00
#    - service: notify.ios_ryans_iphone_app
#      data:
#        message: "after wait is state"

- alias: test wait state
  initial_state: 'off'
  trigger:
    platform: state
    entity_id: device_tracker.ryans_iphone_app
  action:
    - service: notify.ios_ryans_iphone_app
      data:
        message: "before wait states"
    - wait_template: "{{states.input_boolean.test.state == on}}"
      timeout: 00:01:00
    - service: notify.ios_ryans_iphone_app
      data:
        message: "after wait states"

- alias: test wait is_state
  initial_state: 'off'
  trigger:
    platform: state
    entity_id: device_tracker.ryans_iphone_app
  action:
    - service: notify.ios_ryans_iphone_app
      data:
        message: "before wait is state"
    - wait_template: "{{is_state('input_boolean.test', 'on')}}"
      timeout: 00:01:00
    - service: notify.ios_ryans_iphone_app
      data:
        message: "after wait is state"